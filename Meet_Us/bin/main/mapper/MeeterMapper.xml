<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Meet_Us.meeter.dao.MeeterMapper">

<insert id="insertMeetingBoard">
INSERT INTO MEETING_BOARD(				
	MB_WRITER										
    , MB_MEMBER			
    , MB_MEETING_DATE	
    , MB_MEETING_TIME
    , MB_PURPOSE		
    , MB_PLACE			
    , MB_TITLE				
    , MB_CONTENTS
    , MB_LIMIT_AGE_MIN				
    , MB_LIMIT_AGE_MAX
    , MB_LIMIT_GENDER	
    , MB_LIMIT_OTHER 	
    )
    VALUES(
    '이건우'
    , #{MB_MEMBER}
    , #{MB_MEETING_DATE}
    , #{MB_MEETING_TIME}
    , #{MB_PURPOSE}
    , #{MB_PLACE}
    , #{MB_TITLE}
    , #{MB_CONTENTS}
    , #{MB_LIMIT_AGE_MIN}	
    , #{MB_LIMIT_AGE_MAX}				
    , #{MB_LIMIT_GENDER}
    , #{MB_LIMIT_OTHER}
)
</insert>
  
<update id="viewCountIncrease">
     UPDATE 
     	MEETING_BOARD 
     SET 
     	MB_VIEW_COUNT = MB_VIEW_COUNT+1 
     WHERE 
     	MB_NO = #{no}
</update>
       
<select id="selectMeetingList" parameterType="hashmap" resultType="Meet_Us.meeter.vo.MeetingBoardVo" >
	<![CDATA[
		SELECT
						*
		FROM 
	               		MEETING_BOARD
		WHERE 
	               		MB_DELFLAG='N'
		ORDER BY
				   		MB_NO DESC
		LIMIT 
						#{pageStart}, #{perPageNum}
	]]>
</select>

<select id="selectCountMeetingList" resultType="hashmap">
	<![CDATA[
		SELECT 
    					@rownum:=@rownum+1 No,
   					 	MB_NO,
  					  	MB_DELFLAG
		FROM 
						MEETING_BOARD,
						(SELECT @rownum:=0) r
   		WHERE
       				    MB_DELFLAG = 'N'
	]]>
</select>

<select id="selectMeetingDetail" resultType="Meet_Us.meeter.vo.MeetingBoardVo">
	<![CDATA[
		SELECT 
						*
		FROM 
						MEETING_BOARD,
		  				(SELECT @rownum:=0) r
		WHERE 
						MB_DELFLAG = 'N'
		AND 
						MB_NO = #{MB_NO}
	]]>
</select>

<select id="selectCountSearchMeetingList" parameterType="Meet_Us.meeter.vo.PageCriteria" resultType="hashmap">
	<![CDATA[
		SELECT 
    					@rownum:=@rownum+1 No
                        , MB_NO
                        , MB_VIEW_COUNT
                        , MB_MEMBER
                        , MB_CURRENT_MEMBER
                        , MB_MEETING_DATE
                        , MB_MEETING_TIME
                        , MB_PURPOSE
                        , MB_PLACE
                        , MB_TITLE
		FROM 
						MEETING_BOARD,
						(SELECT @rownum:=0) r
   		WHERE
                        MB_PLACE LIKE CONCAT('%', #{PlaceKeyword}, '%')
						OR MB_PURPOSE LIKE CONCAT('%', #{PurposeKeyword}, '%')
						OR MB_MEETING_DATE LIKE CONCAT('%', #{DateKeyword}, '%')
                        OR MB_TITLE LIKE CONCAT('%', #{TitleKeyword}, '%')
                        AND  MB_DELFLAG = 'N'
	]]>
</select>

<select id="selectSearchMeetingList" resultType="Meet_Us.meeter.vo.MeetingBoardVo">
	<![CDATA[
		SELECT 
    					@rownum:=@rownum+1 No
                        , MB_NO
                        , MB_VIEW_COUNT
                        , MB_MEMBER
                        , MB_CURRENT_MEMBER
                        , MB_MEETING_DATE
                        , MB_MEETING_TIME
                        , MB_PURPOSE
                        , MB_PLACE
                        , MB_TITLE
		FROM 
						MEETING_BOARD,
						(SELECT @rownum:=0) r
   		WHERE
                        MB_PLACE LIKE CONCAT('%', #{PlaceKeyword}, '%')
						OR MB_PURPOSE LIKE CONCAT('%', #{PurposeKeyword}, '%')
						OR MB_MEETING_DATE LIKE CONCAT('%', #{DateKeyword}, '%')
                        OR MB_TITLE LIKE CONCAT('%', #{TitleKeyword}, '%')
                        AND  MB_DELFLAG = 'N'
       	ORDER BY                   
						NO DESC, MB_NO DESC
		LIMIT 
						#{pageStart}, #{perPageNum}
	]]>
</select>
	
</mapper>